<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing network scale-up data using the networkreporting package • networkreporting</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing network scale-up data using the networkreporting package">
<meta property="og:description" content="networkreporting">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-5CY4HESMNP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-5CY4HESMNP');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">networkreporting</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="network_scaleup_files/header-attrs-2.5/header-attrs.js"></script><link href="network_scaleup_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="network_scaleup_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analyzing network scale-up data using the networkreporting package</h1>
                        <h4 class="author">Dennis M. Feehan</h4>
            
            <h4 class="date">2020-11-08</h4>
      
      
      <div class="hidden name"><code>network_scaleup.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <strong>networkreporting</strong> package has several tools for analyzing survey data that have been collected using the network scale-up method.</p>
<p>This introduction will assume that you already have the <strong>networkreporting</strong> package installed. If you don’t, please refer to the introductory vignette (“getting started”) for instructions on how to do this.</p>
</div>
<div id="review-of-the-network-scale-up-method" class="section level2">
<h2 class="hasAnchor">
<a href="#review-of-the-network-scale-up-method" class="anchor"></a>Review of the network scale-up method</h2>
<p>For the purposes of this vignette, we’ll assume that you have conducted a survey using network scale-up questions in order to estimate the size of a hidden population. Analytically, using the scale-up estimator involves two steps:</p>
<ul>
<li>step 1: estimating the size of the survey respondents’ personal networks (their <em>degrees</em>)</li>
<li>step 2: estimating the size of the hidden population by combining the estimated network sizes (from step 1) with the number of connections to the hidden population</li>
</ul>
<p>We’ll quickly review each of these steps, and then we’ll show how to use the package to carry the estimation out.</p>
<div id="step-1-estimating-network-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#step-1-estimating-network-sizes" class="anchor"></a>Step 1: estimating network sizes</h3>
<p>Here, we will use the <em>known population</em> estimator for respondents’ degrees (Killworth et al., 1998; Feehan and Salganik, 2016). In order to estimate the degree of the <span class="math inline">\(i\)</span> th survey respondent, we use</p>
<p><span class="math display">\[
\begin{align}
\label{eqn:kpdegree}
\hat{d_i} = \sum_{j=1}^{K} y_{ij} \times 
\frac{N}{\sum_{j=1}^{K} N_j},
\end{align}
\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the total size of the population, <span class="math inline">\(N_j\)</span> is the size of the <span class="math inline">\(j\)</span> th population of known size, and <span class="math inline">\(y_{ij}\)</span> is the number of connections that survey respondent <span class="math inline">\(i\)</span> reports between herself and members of the <span class="math inline">\(j\)</span> th population of known size.</p>
</div>
<div id="step-2-estimating-hidden-population-sizes" class="section level3">
<h3 class="hasAnchor">
<a href="#step-2-estimating-hidden-population-sizes" class="anchor"></a>Step 2: estimating hidden population sizes</h3>
<p>Once we have the estimates of the respondents’ degrees, we use them to produce an estimate for the size of the hidden population:</p>
<p><span class="math display">\[
\begin{align}
\label{eqn:nsum}
\hat{N}_h = \frac{ \sum_{i \in s} y_{ih} }{ \sum_{i \in s} \hat{d_i} },
\end{align}
\]</span></p>
<p>where <span class="math inline">\(N_h\)</span> is the size of the population of interest (which we want to estimate), <span class="math inline">\(s\)</span> is the set of respondents in our sample, and <span class="math inline">\(\hat{d_i}\)</span> is the estimate of the size of respondent <span class="math inline">\(i\)</span>’s degree, obtained using the known population method.</p>
</div>
</div>
<div id="preparing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-data" class="anchor"></a>Preparing data</h2>
<p>In order to use the package, we will assume that you start with two datasets: the first is a survey containing information collected from respondents about their personal networks; the second is information about the sizes of several populations.</p>
<p>The example data for this vignette are provided with the <code>networkreporting</code> package, and can be loaded by typing</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">networkreporting</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">surveybootstrap</span><span class="op">)</span>

<span class="co">## column names for connections to hidden population numbers</span>
<span class="va">hidden.q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sex.workers"</span>, <span class="st">"msm"</span>, <span class="st">"idu"</span>, <span class="st">"clients"</span><span class="op">)</span>

<span class="co">## column names for connections to groups of known size</span>
<span class="va">hm.q</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"widower"</span>, <span class="st">"nurse.or.doctor"</span>, <span class="st">"male.community.health"</span>, <span class="st">"teacher"</span>, 
          <span class="st">"woman.smoke"</span>, <span class="st">"priest"</span>, <span class="st">"civil.servant"</span>, <span class="st">"woman.gave.birth"</span>, 
          <span class="st">"muslim"</span>, <span class="st">"incarcerated"</span>, <span class="st">"judge"</span>, <span class="st">"man.divorced"</span>, <span class="st">"treatedfortb"</span>, 
          <span class="st">"nsengimana"</span>, <span class="st">"murekatete"</span>, <span class="st">"twahirwa"</span>, <span class="st">"mukandekezi"</span>, <span class="st">"nsabimana"</span>, 
          <span class="st">"mukamana"</span>, <span class="st">"ndayambaje"</span>, <span class="st">"nyiraneza"</span>, <span class="st">"bizimana"</span>, <span class="st">"nyirahabimana"</span>, 
          <span class="st">"ndagijimana"</span>, <span class="st">"mukandayisenga"</span>, <span class="st">"died"</span><span class="op">)</span>

<span class="co">## size of the entire population</span>
<span class="va">tot.pop.size</span> <span class="op">&lt;-</span> <span class="fl">10718378</span></pre></div>
<p>The example data include two datasets: one has all of the responses from a network scale-up survey, and the other has the known population sizes for use with the known population estimator.</p>
<div id="preparing-the-known-population-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-the-known-population-data" class="anchor"></a>Preparing the known population data</h3>
<p>The demo known population data are in <code>example.knownpop.dat</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="va">example.knownpop.dat</span></pre></div>
<pre><code>##               known.popn   size
## 1                widower  36147
## 2        nurse.or.doctor   7807
## 3  male.community.health  22000
## 4                teacher  47745
## 5            woman.smoke 119438
## 6                 priest   1004
## 7       woman.gave.birth 256164
## 8                 muslim 195449
## 9           incarcerated  68000
## 10          man.divorced  50698
## 11            nsengimana  32528
## 12            murekatete  30531
## 13              twahirwa  10420
## 14           mukandekezi  10520
## 15             nsabimana  48560
## 16              mukamana  51449
## 17            ndayambaje  22724
## 18             nyiraneza  21705
## 19              bizimana  38497
## 20         nyirahabimana  42727
## 21           ndagijimana  37375
## 22        mukandayisenga  35055</code></pre>
<p><code>example.knownpop.dat</code> is very simple: one column has a name for each known population, and the other has its toal size. We expect that users will typically start with a small dataset like this one. When using the <code>networkreporting</code> package, it is more useful to have a vector whose entries are known population sizes and whose names are the known population names. The <code>df.to.kpvec</code> function makes it easy for us to create it:</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">kp.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/df.to.kpvec.html">df.to.kpvec</a></span><span class="op">(</span><span class="va">example.knownpop.dat</span>, kp.var<span class="op">=</span><span class="st">"known.popn"</span>, kp.value<span class="op">=</span><span class="st">"size"</span><span class="op">)</span>

<span class="va">kp.vec</span></pre></div>
<pre><code>##               widower       nurse.or.doctor male.community.health 
##                 36147                  7807                 22000 
##               teacher           woman.smoke                priest 
##                 47745                119438                  1004 
##      woman.gave.birth                muslim          incarcerated 
##                256164                195449                 68000 
##          man.divorced            nsengimana            murekatete 
##                 50698                 32528                 30531 
##              twahirwa           mukandekezi             nsabimana 
##                 10420                 10520                 48560 
##              mukamana            ndayambaje             nyiraneza 
##                 51449                 22724                 21705 
##              bizimana         nyirahabimana           ndagijimana 
##                 38497                 42727                 37375 
##        mukandayisenga 
##                 35055</code></pre>
<p>Finally, we also need to know the total size of the population we are making estimates about. In this case, let’s assume that we’re working in a country of 10 million people:</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># total size of the population</span>
<span class="va">tot.pop.size</span> <span class="op">&lt;-</span> <span class="fl">10e6</span></pre></div>
</div>
<div id="preparing-the-survey-data" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-the-survey-data" class="anchor"></a>Preparing the survey data</h3>
<p>Now let’s take a look at the demo survey dataset, which is called <code>example.survey</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">example.survey</span><span class="op">)</span></pre></div>
<pre><code>##      id cluster      region indweight  sex age.cat widower nurse.or.doctor
## 1 1.1.1       1 Kigali City  0.330602 Male [25,35)       3               2
## 2 1.1.2       1 Kigali City  0.330602 Male [25,35)       0               2
## 3 1.1.3       1 Kigali City  0.330602 Male [25,35)       2               8
## 4 1.1.4       1 Kigali City  0.330602 Male [25,35)       0               1
## 5 1.1.5       1 Kigali City  0.330602 Male [25,35)       0               0
## 6 1.1.6       1 Kigali City  0.330602 Male [25,35)       7               4
##   male.community.health teacher woman.smoke priest civil.servant
## 1                     1       5           1      0             5
## 2                     1       5           0      0             5
## 3                     0       3           0      0            50
## 4                     0       0           0      0             5
## 5                     0       0           0      0             5
## 6                     0       8           2      0             6
##   woman.gave.birth muslim incarcerated judge man.divorced treatedfortb
## 1                3      4            2     3            2            0
## 2                3      0            2     3            1            0
## 3                4      3            0     0            2            0
## 4                0      0            0     0            0            0
## 5                0      0            0     0            1            0
## 6                3      4            3     0            1            0
##   nsengimana murekatete twahirwa mukandekezi nsabimana mukamana ndayambaje
## 1          0          0        2           1         2        3          1
## 2          3          2        0           0         1        0          0
## 3          0          0        0           1         2        0          0
## 4          1          0        0           0         0        0          0
## 5          0          0        0           0         0        0          0
## 6          1          1        0           0         0        0          0
##   nyiraneza bizimana nyirahabimana ndagijimana mukandayisenga died sex.workers
## 1         0        2             0           1              0    0           0
## 2         0        0             0           0              0    1           0
## 3         0        0             0           0              0    2           0
## 4         0        0             0           0              0    0           0
## 5         0        0             0           0              0    0           0
## 6         0        0             0           0              0    4           0
##   msm idu clients
## 1   0   0       2
## 2   0   0       1
## 3   0   0       0
## 4   0   0       0
## 5   0   0       0
## 6   0   0      10</code></pre>
<p>The columns fall into a few categories:</p>
<ul>
<li>an id variable for each respondent: <code>id</code>
</li>
<li>information related to the sampling design of the survey: <code>cluster</code>, <code>region</code>, and <code>indweight</code>.</li>
<li>demographic characteristics of the respondents: <code>sex</code> and <code>age.cat</code>
</li>
<li>responses to questiona bout populations whose total size is known: <code>widower</code>, …, <code>mukandayisenga</code>
</li>
<li>questions about hidden populations: <code>died</code>, …, <code>clients</code>
</li>
</ul>
<p>This is the general form that your survey dataset should have.</p>
<div id="topcoding" class="section level4">
<h4 class="hasAnchor">
<a href="#topcoding" class="anchor"></a>Topcoding</h4>
<p>Many network scale-up studies have topcoded the responses to the aggregate relational data questions. This means that researchers considered any responses above a certain value, called the topcode, to be implausible. Before proceeding with the analysis, researchers substitute the maximum plausible value in for the implausible ones. For example, in many studies, researchers replaced responses with the value 31 or higher with the value 30 before conducting their analysis (see Zheng, Salganik, and Gelman 2006).</p>
<p>We won’t discuss whether or not this is advisable here, but this is currently a common practice in scale-up studies. If you wish to follow it, you can use the <code>topcode.data</code> function. For example, let’s topcode the responses to the questions about populations of known size to the value 30. First, we’ll examine the distribution of the responses before topcoding:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="co">## make a vector with the list of known population names from</span>
<span class="co">## our dataset of known population totals</span>
<span class="va">known.popn.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">example.knownpop.dat</span><span class="op">$</span><span class="va">known.popn</span><span class="op">)</span>

<span class="co">## before topcoding: max. response for several popns is &gt; 30</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">example.survey</span><span class="op">[</span>,<span class="va">known.popn.vars</span><span class="op">]</span><span class="op">)</span></pre></div>
<pre><code>##     widower        nurse.or.doctor   male.community.health    teacher      
##  Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.000        Min.   : 0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.000        1st Qu.: 0.000  
##  Median : 0.0000   Median : 0.0000   Median : 0.000        Median : 0.000  
##  Mean   : 0.6101   Mean   : 0.5112   Mean   : 0.724        Mean   : 1.356  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000   3rd Qu.: 1.000        3rd Qu.: 1.000  
##  Max.   :95.0000   Max.   :40.0000   Max.   :95.000        Max.   :95.000  
##                                                                            
##   woman.smoke         priest        woman.gave.birth     muslim      
##  Min.   : 0.000   Min.   : 0.0000   Min.   : 0.000   Min.   : 0.000  
##  1st Qu.: 0.000   1st Qu.: 0.0000   1st Qu.: 0.000   1st Qu.: 0.000  
##  Median : 0.000   Median : 0.0000   Median : 1.000   Median : 0.000  
##  Mean   : 1.022   Mean   : 0.1484   Mean   : 1.885   Mean   : 2.094  
##  3rd Qu.: 1.000   3rd Qu.: 0.0000   3rd Qu.: 3.000   3rd Qu.: 1.000  
##  Max.   :95.000   Max.   :25.0000   Max.   :30.000   Max.   :95.000  
##                                                      NA's   :1       
##   incarcerated      man.divorced       nsengimana       murekatete     
##  Min.   : 0.0000   Min.   : 0.0000   Min.   :0.0000   Min.   : 0.0000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.:0.0000   1st Qu.: 0.0000  
##  Median : 0.0000   Median : 0.0000   Median :0.0000   Median : 0.0000  
##  Mean   : 0.4348   Mean   : 0.3367   Mean   :0.3603   Mean   : 0.3425  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000   3rd Qu.:0.0000   3rd Qu.: 1.0000  
##  Max.   :95.0000   Max.   :20.0000   Max.   :8.0000   Max.   :12.0000  
##                                                                        
##     twahirwa        mukandekezi      nsabimana          mukamana      
##  Min.   : 0.0000   Min.   :0.000   Min.   : 0.0000   Min.   : 0.0000  
##  1st Qu.: 0.0000   1st Qu.:0.000   1st Qu.: 0.0000   1st Qu.: 0.0000  
##  Median : 0.0000   Median :0.000   Median : 0.0000   Median : 0.0000  
##  Mean   : 0.2394   Mean   :0.165   Mean   : 0.4705   Mean   : 0.4144  
##  3rd Qu.: 0.0000   3rd Qu.:0.000   3rd Qu.: 1.0000   3rd Qu.: 1.0000  
##  Max.   :10.0000   Max.   :7.000   Max.   :20.0000   Max.   :15.0000  
##                                                                       
##    ndayambaje        nyiraneza          bizimana       nyirahabimana   
##  Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.000  
##  Median : 0.0000   Median : 0.0000   Median : 0.0000   Median : 0.000  
##  Mean   : 0.3296   Mean   : 0.2685   Mean   : 0.4331   Mean   : 0.261  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000   3rd Qu.: 1.0000   3rd Qu.: 0.000  
##  Max.   :30.0000   Max.   :10.0000   Max.   :12.0000   Max.   :17.000  
##                                                                        
##   ndagijimana      mukandayisenga   
##  Min.   : 0.0000   Min.   : 0.0000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000  
##  Median : 0.0000   Median : 0.0000  
##  Mean   : 0.3279   Mean   : 0.2577  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000  
##  Max.   :10.0000   Max.   :20.0000  
## </code></pre>
<p>Several populations, including <code>widower</code>, <code>male.community.health</code>, <code>teacher</code>, <code>woman.smoke</code>, <code>muslim</code>, and <code>incarcerated</code> have maximum values that are very high. (It turns out that 95 is the highest value that could be recorded during the interviews; if respondents said that they were connected to more than 95 people in the group, the interviewers wrote 95 down.)</p>
<p>Now we use the <code>topcode.data</code> function to topcode all of the responses at 30:</p>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="va">example.survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/topcode.data.html">topcode.data</a></span><span class="op">(</span><span class="va">example.survey</span>,
                               vars<span class="op">=</span><span class="va">known.popn.vars</span>,
                               max<span class="op">=</span><span class="fl">30</span><span class="op">)</span>

<span class="co">## after topcoding: max. response for all popns is 30</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">example.survey</span><span class="op">[</span>,<span class="va">known.popn.vars</span><span class="op">]</span><span class="op">)</span></pre></div>
<pre><code>##     widower        nurse.or.doctor   male.community.health    teacher      
##  Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.000        Min.   : 0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.000        1st Qu.: 0.000  
##  Median : 0.0000   Median : 0.0000   Median : 0.000        Median : 0.000  
##  Mean   : 0.5831   Mean   : 0.5062   Mean   : 0.653        Mean   : 1.216  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000   3rd Qu.: 1.000        3rd Qu.: 1.000  
##  Max.   :30.0000   Max.   :30.0000   Max.   :30.000        Max.   :30.000  
##                                                                            
##   woman.smoke          priest        woman.gave.birth     muslim      
##  Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.000   Min.   : 0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.000   1st Qu.: 0.000  
##  Median : 0.0000   Median : 0.0000   Median : 1.000   Median : 0.000  
##  Mean   : 0.9638   Mean   : 0.1484   Mean   : 1.885   Mean   : 1.468  
##  3rd Qu.: 1.0000   3rd Qu.: 0.0000   3rd Qu.: 3.000   3rd Qu.: 1.000  
##  Max.   :30.0000   Max.   :25.0000   Max.   :30.000   Max.   :30.000  
##                                                       NA's   :1       
##   incarcerated      man.divorced       nsengimana       murekatete     
##  Min.   : 0.0000   Min.   : 0.0000   Min.   :0.0000   Min.   : 0.0000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.:0.0000   1st Qu.: 0.0000  
##  Median : 0.0000   Median : 0.0000   Median :0.0000   Median : 0.0000  
##  Mean   : 0.3807   Mean   : 0.3367   Mean   :0.3603   Mean   : 0.3425  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000   3rd Qu.:0.0000   3rd Qu.: 1.0000  
##  Max.   :30.0000   Max.   :20.0000   Max.   :8.0000   Max.   :12.0000  
##                                                                        
##     twahirwa        mukandekezi      nsabimana          mukamana      
##  Min.   : 0.0000   Min.   :0.000   Min.   : 0.0000   Min.   : 0.0000  
##  1st Qu.: 0.0000   1st Qu.:0.000   1st Qu.: 0.0000   1st Qu.: 0.0000  
##  Median : 0.0000   Median :0.000   Median : 0.0000   Median : 0.0000  
##  Mean   : 0.2394   Mean   :0.165   Mean   : 0.4705   Mean   : 0.4144  
##  3rd Qu.: 0.0000   3rd Qu.:0.000   3rd Qu.: 1.0000   3rd Qu.: 1.0000  
##  Max.   :10.0000   Max.   :7.000   Max.   :20.0000   Max.   :15.0000  
##                                                                       
##    ndayambaje        nyiraneza          bizimana       nyirahabimana   
##  Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.0000   Min.   : 0.000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.0000   1st Qu.: 0.000  
##  Median : 0.0000   Median : 0.0000   Median : 0.0000   Median : 0.000  
##  Mean   : 0.3296   Mean   : 0.2685   Mean   : 0.4331   Mean   : 0.261  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000   3rd Qu.: 1.0000   3rd Qu.: 0.000  
##  Max.   :30.0000   Max.   :10.0000   Max.   :12.0000   Max.   :17.000  
##                                                                        
##   ndagijimana      mukandayisenga   
##  Min.   : 0.0000   Min.   : 0.0000  
##  1st Qu.: 0.0000   1st Qu.: 0.0000  
##  Median : 0.0000   Median : 0.0000  
##  Mean   : 0.3279   Mean   : 0.2577  
##  3rd Qu.: 0.0000   3rd Qu.: 0.0000  
##  Max.   :10.0000   Max.   :20.0000  
## </code></pre>
<p>If you look at the help page for <code>topcode.data</code>, you’ll see that it can also handle situations where the variables can take on special codes for missing values, refusals, and so forth.</p>
</div>
</div>
</div>
<div id="estimating-network-sizes" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-network-sizes" class="anchor"></a>Estimating network sizes</h2>
<p>Now that we have finished preparing the data, we turn to esimating the sizes of each respondent’s personal network. To do this using the known population estimator, we use the <code>kp.degree.estimator</code> function:</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="va">d.hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/kp.individual.estimator.html">kp.individual.estimator_</a></span><span class="op">(</span>resp.data<span class="op">=</span><span class="va">example.survey</span>,
                                  known.populations<span class="op">=</span><span class="va">known.popn.vars</span>,
                                  total.kp.size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">kp.vec</span><span class="op">)</span>,
                                  alter.popn.size<span class="op">=</span><span class="va">tot.pop.size</span><span class="op">)</span><span class="op">$</span><span class="va">dbar.Fcell.F</span></pre></div>
<pre><code>## Warning: `select_()` is deprecated as of dplyr 0.7.0.
## Please use `select()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## NOTE: Ignoring any rows with missingness on any of the report variables.</code></pre>
<pre><code>## Warning: `rename_()` is deprecated as of dplyr 0.7.0.
## Please use `rename()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">d.hat</span><span class="op">)</span></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.00   25.28   58.99  101.21  126.42 1904.69</code></pre>
<p>We can examine the results with a histogram</p>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># we'll use qplot from ggplot2 for plots</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">d.hat</span>, binwidth<span class="op">=</span><span class="fl">25</span><span class="op">)</span></pre></div>
<p><img src="network_scaleup_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Now let’s append the degree estimates to the survey reports dataframe:</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="va">example.survey</span><span class="op">$</span><span class="va">d.hat</span> <span class="op">&lt;-</span> <span class="va">d.hat</span></pre></div>
<!--
### Missing data in known population questions

For now, we do not explicitly address missing data in the reported connections to the known
populations. Future versions of the package may include tools to help address this issue.
-->
</div>
<div id="estimating-hidden-population-size" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-hidden-population-size" class="anchor"></a>Estimating hidden population size</h2>
<p>Now that you have estimated degrees, you can use them to produce estimates of the size of the hidden population. Here, we’ll take the example of clients of female sex workers, <code>clients</code></p>
<div class="sourceCode" id="cb22"><pre class="downlit">
<span class="va">idu.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nsum.estimator.html">nsum.estimator</a></span><span class="op">(</span>survey.data<span class="op">=</span><span class="va">example.survey</span>,
                          d.hat.vals<span class="op">=</span><span class="va">d.hat</span>,
                          total.popn.size<span class="op">=</span><span class="va">tot.pop.size</span>,
                          y.vals<span class="op">=</span><span class="st">"clients"</span>,
                          missing<span class="op">=</span><span class="st">"complete.obs"</span><span class="op">)</span></pre></div>
<p>Note that we had to specify that we should use only rows in our dataset with no missing values through the <code>missing = "complete.obs"</code> option, and also that we had to pass in the total population size using the <code>total.popn.size</code> option. The resulting estimate is</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="va">idu.est</span></pre></div>
<pre><code>## $estimate
## [1] 47798.44
## 
## $tot.connections
## [1] 1164
## 
## $sum.d.hat
## [1] 243522.6</code></pre>
<p>This returns the estimate, and also the numerator and denominator used to compute it.</p>
</div>
<div id="variance-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#variance-estimation" class="anchor"></a>Variance estimation</h2>
<p>In order to estimate the sampling uncertainty of our estimated totals, we can use the rescaled bootstrap technique; see Feehan and Salganik 2016 for more about the rescaled boostrap and how it can be applied to the network scale-up method. In order to use the rescaled boostrap, you need to be able to specify the sampling design of your study. In particular, you need to be able to describe the stratifcation (if any) and the primary sampling units used in the study.</p>
<div class="sourceCode" id="cb25"><pre class="downlit">
<span class="va">idu.est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/surveybootstrap/man/bootstrap.estimates.html">bootstrap.estimates</a></span><span class="op">(</span><span class="co">## this describes the sampling design of the</span>
                               <span class="co">## survey; here, the PSUs are given by the</span>
                               <span class="co">## variable cluster, and the strata are given</span>
                               <span class="co">## by the variable region</span>
                               survey.design <span class="op">=</span> <span class="op">~</span> <span class="va">cluster</span> <span class="op">+</span> <span class="fu">strata</span><span class="op">(</span><span class="va">region</span><span class="op">)</span>,
                               <span class="co">## the number of bootstrap resamples to obtain</span>
                               <span class="co">## (NOTE: in practice, you should use more than 100.</span>
                               <span class="co">##  this keeps building the package relatively fast)</span>
                               num.reps<span class="op">=</span><span class="fl">100</span>,
                               <span class="co">## this is the name of the function</span>
                               <span class="co">## we want to use to produce an estimate</span>
                               <span class="co">## from each bootstrapped dataset</span>
                               estimator.fn<span class="op">=</span><span class="st">"nsum.estimator"</span>,
                               <span class="co">## these are the sampling weights</span>
                               weights<span class="op">=</span><span class="st">"indweight"</span>,
                               <span class="co">## this is the name of the type of bootstrap</span>
                               <span class="co">## we wish to use</span>
                               bootstrap.fn<span class="op">=</span><span class="st">"rescaled.bootstrap.sample"</span>,
                               <span class="co">## our dataset</span>
                               survey.data<span class="op">=</span><span class="va">example.survey</span>,
                               <span class="co">## other parameters we need to pass</span>
                               <span class="co">## to the nsum.estimator function</span>
                               d.hat.vals<span class="op">=</span><span class="va">d.hat</span>,
                               total.popn.size<span class="op">=</span><span class="va">tot.pop.size</span>,
                               y.vals<span class="op">=</span><span class="st">"clients"</span>,
                               missing<span class="op">=</span><span class="st">"complete.obs"</span><span class="op">)</span></pre></div>
<pre><code>## Warning: `group_indices_()` is deprecated as of dplyr 0.7.0.
## Please use `group_indices()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre><code>## Warning: The `...` argument of `group_keys()` is deprecated as of dplyr 1.0.0.
## Please `group_by()` first
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<p>By default, <code>bootstrap.estimates</code> produces a list with <code>num.reps</code> entries; each entry is the result of calling the estimator function on one bootstrap resample.</p>
<p>Next, you can write a bit of code that will help us put all of these results together, for plotting and summarizing</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr">plyr</a></span><span class="op">)</span>
<span class="co">## combine the estimates together in one data frame</span>
<span class="co">## (bootstrap.estimates gives us a list)</span>
<span class="va">all.idu.estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html">ldply</a></span><span class="op">(</span><span class="va">idu.est</span>,
                           <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>estimate<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></pre></div>
<p>We can examine the summarized results with a histogram or with <code>summarize</code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit">
<span class="co">## look at a histogram of the results</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">all.idu.estimates</span><span class="op">$</span><span class="va">estimate</span>, binwidth<span class="op">=</span><span class="fl">500</span><span class="op">)</span></pre></div>
<p><img src="network_scaleup_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="co">## summarize the results</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">all.idu.estimates</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   25346   32529   35057   34909   36577   44746</code></pre>
<p>To produce 95% intervals using the percentile method you can do something like this</p>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">all.idu.estimates</span><span class="op">$</span><span class="va">estimate</span>, probs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></pre></div>
<pre><code>##     2.5%    97.5% 
## 28182.84 42362.41</code></pre>
</div>
<div id="internal-consistency-checks" class="section level2">
<h2 class="hasAnchor">
<a href="#internal-consistency-checks" class="anchor"></a>Internal consistency checks</h2>
<p>If you want to run internal consistency checks (see e.g. <a href="https://doi.org/10.1093/aje/kwv287">Feehan et al., 2016, Fig 3</a>), you can use the <code>nsum.internal.consistency</code> function. We specify that we wish to use only complete observations (ie, we will remove rows that have any missing values from our calculations).</p>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="va">ic.result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nsum.internal.consistency.html">nsum.internal.consistency</a></span><span class="op">(</span>survey.data<span class="op">=</span><span class="va">example.survey</span>,
                                      known.popns<span class="op">=</span><span class="va">kp.vec</span>,
                                      missing<span class="op">=</span><span class="st">"complete.obs"</span>,
                                      killworth.se<span class="op">=</span><span class="cn">TRUE</span>,
                                      total.popn.size<span class="op">=</span><span class="va">tot.pop.size</span>,
                                      alter.popn.size<span class="op">=</span><span class="va">tot.pop.size</span>,
                                      kp.method<span class="op">=</span><span class="cn">TRUE</span>,
                                      return.plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></pre></div>
<pre><code>## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.
## 
## NOTE: Ignoring any rows with missingness on any of the report variables.</code></pre>
<p>Now <code>ic.result</code> is a list that has a summary of the results in the entry <code>results</code></p>
<div class="sourceCode" id="cb36"><pre class="downlit">
<span class="va">ic.result</span><span class="op">$</span><span class="va">results</span></pre></div>
<pre><code>##                     name nsum.holdout.est known.size d.hat.sum killworth.se
## 1                widower         58708.19      36147  238978.6    1562.7564
## 2        nurse.or.doctor         51873.41       7807  234802.4    1482.4902
## 3  male.community.health         66955.68      22000  234632.8    1683.6063
## 4                teacher        128262.77      47745  228047.5    2356.3211
## 5            woman.smoke         93114.71     119438  249047.7    1924.5823
## 6                 priest         14830.66       1004  240717.5     784.3396
## 7       woman.gave.birth        173204.79     256164  261828.8    2549.6303
## 8                 muslim        137934.15     195449  255929.3    2305.5174
## 9           incarcerated         36619.80      68000  250137.9    1207.7348
## 10          man.divorced         32758.93      50698  247260.8    1149.1445
## 11            nsengimana         35697.55      32528  242873.8    1210.1866
## 12            murekatete         33933.74      30531  242826.2    1180.1303
## 13              twahirwa         23921.99      10420  240782.6     995.5567
## 14           mukandekezi         16382.94      10520  242325.2     821.5626
## 15             nsabimana         46399.77      48560  243966.7    1375.8868
## 16              mukamana         40565.23      51449  245777.0    1282.1053
## 17            ndayambaje         32841.38      22724  241463.7    1164.3150
## 18             nyiraneza         26637.59      21705  242514.4    1046.6453
## 19              bizimana         42949.20      38497  242612.2    1327.6590
## 20         nyirahabimana         25411.84      42727  247128.9    1012.7535
## 21           ndagijimana         32259.79      37375  244576.9    1146.6248
## 22        mukandayisenga         25249.25      35055  245551.8    1012.7533
##    killworth.se.wgtdenom        err    abserr      sqerr      relerr
## 1              1562.7564  22561.191 22561.191  509007341  0.62415113
## 2              1482.4902  44066.413 44066.413 1941848743  5.64447456
## 3              1683.6063  44955.682 44955.682 2021013338  2.04344009
## 4              2356.3211  80517.771 80517.771 6483111367  1.68641262
## 5              1924.5823 -26323.291 26323.291  692915672  0.22039294
## 6               784.3396  13826.662 13826.662  191176573 13.77157538
## 7              2549.6303 -82959.207 82959.207 6882229975  0.32385193
## 8              2305.5174 -57514.848 57514.848 3307957792  0.29427036
## 9              1207.7348 -31380.200 31380.200  984716944  0.46147353
## 10             1149.1445 -17939.074 17939.074  321810359  0.35384184
## 11             1210.1866   3169.553  3169.553   10046064  0.09744075
## 12             1180.1303   3402.735  3402.735   11578609  0.11145182
## 13              995.5567  13501.990 13501.990  182303747  1.29577644
## 14              821.5626   5862.944  5862.944   34374109  0.55731404
## 15             1375.8868  -2160.232  2160.232    4666603  0.04448583
## 16             1282.1053 -10883.772 10883.772  118456503  0.21154488
## 17             1164.3150  10117.380 10117.380  102361383  0.44522884
## 18             1046.6453   4932.592  4932.592   24330468  0.22725604
## 19             1327.6590   4452.195  4452.195   19822041  0.11565044
## 20             1012.7535 -17315.161 17315.161  299814807  0.40525104
## 21             1146.6248  -5115.214  5115.214   26165412  0.13686191
## 22             1012.7533  -9805.749  9805.749   96152722  0.27972470</code></pre>
<p>Since we passed the argument <code>return.plot=TRUE</code> to the function, we also get a plot:</p>
<div class="sourceCode" id="cb38"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ic.result</span><span class="op">$</span><span class="va">plot</span><span class="op">)</span></pre></div>
<p><img src="network_scaleup_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
<p>This plot is a <code>ggplot2</code> object, so we can customize it if we want. As a very simple example, we can change the title:</p>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">ic.result</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"internal consistency checks"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="network_scaleup_files/figure-html/unnamed-chunk-21-1.png" width="700"></p>
<p>The <a href="http://ggplot2.org/">ggplot2 website</a> has more information on modifying ggplot2 objects.</p>
<!--
Attaching known population totals to the dataframe
--------------------------------------------------

Several of the functions we demonstrated above required us to pass in
the vector containing the known population sizes and also the size of
the total population.  We can avoid this step by attaching these two
pieces of information to the survey dataframe using the `add.kp` function:


```r
example.survey <- add.kp(example.survey, kp.vec, tot.pop.size)

d.hat.new <- kp.degree.estimator(survey.data=example.survey,
                                 # we don't need this anymore, since we
                                 # them to survey.data's attributes using add.kp
                                 #known.popns=kp.vec,
                                 #total.popn.size=tot.pop.size,
                                 missing="complete.obs")

summary(d.hat.new)
```

This is exactly the same result we obtained before.
-->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Dennis M. Feehan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
